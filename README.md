# FastAPI Project Template

This repository provides a robust and scalable template for building RESTful APIs using FastAPI, SQLAlchemy (with AsyncIO), Alembic for migrations, and a structured project layout. It\'s designed to kickstart your next API project with best practices in mind, including authentication, testing, and environment management.

## Table of Contents

- [Features](#features)
- [Project Structure](#project-structure)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
  - [Database Setup](#database-setup)
  - [Running the Application](#running-the-application)
- [Testing](#testing)
- [Environment Variables](#environment-variables)
- [API Documentation](#api-documentation)
- [Alembic Migrations](#alembic-migrations)
- [Contributing](#contributing)
- [License](#license)

## Features

- **FastAPI**: High-performance, easy-to-use web framework.
- **SQLAlchemy with AsyncIO**: Asynchronous ORM for database interactions.
- **Alembic**: Database migration tool for managing schema changes.
- **JWT Authentication**: Secure user authentication and authorization using JSON Web Tokens.
- **Password Hashing**: Secure password storage using `passlib[bcrypt]`.
- **Pydantic**: Data validation and settings management.
- **Structured Project Layout**: Clear separation of concerns (routers, services, models, schemas).
- **Comprehensive Testing**: Unit and integration tests with `pytest` and `httpx`.
- **Environment Management**: Utilizes `.env` for secure configuration.
- **Docker Support**: (Coming soon) Containerization for easy deployment.

## Project Structure

```
.
├── alembic/                      # Alembic migration scripts
│   ├── versions/                 # Directory containing migration scripts generated by Alembic
│   └── env.py                    # Alembic environment configuration
├── app/                          # Main application source code
│   ├── api/                      # API routers and endpoints
│   │   ├── dependencies.py       # Dependency injection for common components (e.g., database session, current user)
│   │   ├── routers/              # Individual API routers for different modules (e.g., users, items)
│   │   │   └── users.py
│   │   └── __init__.py
│   ├── core/                     # Core application configurations and utilities
│   │   ├── config.py             # Application settings loaded from environment variables
│   │   ├── database.py           # Database engine and session setup
│   │   ├── security.py           # Security utilities (password hashing, JWT)
│   │   └── __init__.py
│   ├── models/                   # SQLAlchemy ORM models (database table definitions)
│   │   ├── user.py
│   │   └── __init__.py
│   ├── schemas/                  # Pydantic schemas for request/response data validation
│   │   ├── token.py
│   │   ├── user.py
│   │   └── __init__.py
│   ├── services/                 # Business logic and CRUD operations
│   │   ├── user.py
│   │   └── __init__.py
│   └── main.py                   # Main FastAPI application instance
├── tests/                        # Application tests
│   ├── __init__.py               # Makes tests a package. Used for organizing test files.
│   └── test_user.py              # Unit and integration tests for user routes and services using pytest.
├── .env                          # Environment variables (DATABASE_URL, SECRET_KEY, DEBUG mode, etc.) not committed to version control for security.
├── .gitignore                    # Specifies intentionally untracked files to ignore.
├── alembic.ini                   # Alembic configuration file
├── pyproject.toml                # Project metadata (e.g., poetry config)
├── requirements.txt              # Python dependencies list (FastAPI, Uvicorn, SQLAlchemy, psycopg2, Alembic, Pydantic, python-dotenv, etc.)
└── README.md                     # Project documentation. Explains purpose, setup instructions, usage, and contribution guidelines.
```

## Getting Started

### Prerequisites

Before you begin, ensure you have the following installed:

- Python 3.9+
- PostgreSQL (or another supported database)

### Installation

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/your-username/your-repo-name.git
    cd your-repo-name
    ```

2.  **Create a virtual environment (recommended):**

    ```bash
    python -m venv venv
    source venv/bin/activate # On Windows: `venv\Scripts\activate`
    ```

3.  **Install dependencies:**

    ```bash
    pip install -r requirements.txt
    ```

4.  **Create a `.env` file:**

    Copy the `.env.example` (if provided, or manually create based on the `.env` file content you've seen) and fill in your details. **Crucially, replace placeholders with actual values, especially `SECRET_KEY` and `DATABASE_URL`.**

    ```ini
    # .env
    DATABASE_URL="postgresql+asyncpg://user:password@host:port/dbname"
    SECRET_KEY="your-super-secret-key-please-change-me"
    ALGORITHM="HS256"
    ACCESS_TOKEN_EXPIRE_MINUTES=30
    DEBUG=True
    LOG_LEVEL="INFO"
    ```

### Database Setup

1.  **Ensure your PostgreSQL database is running and accessible.**

2.  **Run Alembic migrations to create tables:**

    ```bash
    alembic upgrade head
    ```

    - If you make changes to your SQLAlchemy models, you'll need to generate new migrations:
      ```bash
      alembic revision --autogenerate -m "Add new feature table"
      alembic upgrade head
      ```

### Running the Application

To start the FastAPI application using Uvicorn:

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

The `--reload` flag enables auto-reloading on code changes, `--host 0.0.0.0` makes the application accessible externally (useful in Docker or network environments), and `--port 8000` sets the listening port.

The API will be available at `http://localhost:8000`.

## Testing

This project uses `pytest` for running tests.

1.  **Ensure you have test dependencies installed:** (they are in `requirements.txt`)

2.  **Run tests:**

    ```bash
    pytest
    ```

    To run specific tests:

    ```bash
    pytest tests/test_user.py
    ```

## Environment Variables

The application configuration is managed through environment variables, loaded via `pydantic-settings` and `python-dotenv`. Refer to the `.env` file for all configurable options.

**Key variables to configure:**

- `DATABASE_URL`: Connection string for your database.
- `SECRET_KEY`: A strong, randomly generated key for JWT signing.
- `ALGORITHM`: JWT signing algorithm (e.g., `HS256`).
- `ACCESS_TOKEN_EXPIRE_MINUTES`: Expiration time for access tokens.
- `DEBUG`: Set to `False` in production for security and performance.

## API Documentation

FastAPI automatically generates interactive API documentation. Once the application is running:

- **Swagger UI**: Access at `http://localhost:8000/docs`
- **ReDoc**: Access at `http://localhost:8000/redoc`

## Alembic Migrations

Alembic is used to manage database schema changes.

- **Generate a new migration script:**
    ```bash
    alembic revision --autogenerate -m "Description of your changes"
    ```
- **Apply migrations:**
    ```bash
    alembic upgrade head
    ```
- **Revert migrations (use with caution):**
    ```bash
    alembic downgrade -1 # Reverts the last migration
    ```

## Contributing

We welcome contributions! If you\'d like to contribute, please follow these steps:

1.  Fork the repository.
2.  Create a new branch for your feature or bug fix: `git checkout -b feature/your-feature-name`.
3.  Make your changes and write tests.
4.  Ensure all tests pass.
5.  Commit your changes: `git commit -m "feat: Add new feature"` or `git commit -m "fix: Fix bug in user creation"`.
6.  Push to your fork: `git push origin feature/your-feature-name`.
7.  Open a Pull Request to the `main` branch of this repository.

Please ensure your code adheres to the project's coding standards and includes appropriate documentation and tests.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
